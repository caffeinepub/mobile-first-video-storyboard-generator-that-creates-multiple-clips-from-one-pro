{
  "kind": "build_request",
  "title": "Force Grok AI normal mode when Grok configuration is available",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-27",
      "text": "Ensure the app automatically selects and stays on the Grok provider (normal mode) whenever Grok configuration is detected (via env vars or saved runtime config), and never remains in Demo mode due to a previously persisted provider selection unless the user has explicitly opted into Demo mode.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Auto set grok ai into normal mode and not demo mode"
        ]
      },
      "acceptanceCriteria": [
        "Given valid Grok configuration is available (env vars or saved runtime config), on a fresh page load the active provider is Grok and the UI shows Grok as Active.",
        "If localStorage contains a previously persisted provider selection of \"demo\" but there is no explicit Demo opt-in flag, the app switches to Grok automatically when Grok is configured.",
        "If the user explicitly opts into Demo mode while Grok is configured, the app remains in Demo mode across reloads until the user switches back to Grok (i.e., auto-switching must not override an explicit Demo choice).",
        "If Grok configuration becomes available while the app is open (runtime config saved), the provider switches to Grok immediately unless the user explicitly opted into Demo mode.",
        "All user-facing messaging related to provider state/configuration remains in English."
      ]
    }
  ],
  "constraints": [
    "Frontend immutable paths must not be edited: frontend/src/hooks/useInternetIdentity.ts, frontend/src/hooks/useInternetIdentity.tsx, frontend/src/hooks/useActor.ts, frontend/src/main.tsx, frontend/src/components/ui/*.",
    "Keep the backend single-actor architecture; no backend changes are required for this request."
  ],
  "nonGoals": [
    "Adding new provider types beyond Grok and Demo.",
    "Changing video generation/composition logic unrelated to provider selection.",
    "Adding or changing authentication behavior."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}